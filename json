[
  {
    "tool_code": "await writeToFileTool(\"src/pages/manufacturer/Medicines.tsx\", \"import { api } from \\\"@/convex/_generated/api\\\";\\nimport { useMutation, useQuery } from \\\"convex/react\\\";\\nimport { motion } from \\\"framer-motion\\\";\\nimport { Plus, Search, Wallet, LogOut } from \\\"lucide-react\\\";\\nimport { Button } from \\\"@/components/ui/button\\\";\\nimport { Input } from \\\"@/components/ui/input\\\";\\nimport { Link } from \\\"react-router\\\";\\nimport { useState }\" + \" from \\\"react\\\";\\nimport { toast } from \\\"sonner\\\";\\nimport { useWeb3 } from \\\"@/hooks/use-web3\\\";\\nimport { MedicinesTable } from \\\"./components/MedicinesTable\\\";\\nimport { MedicineDetailsDialog } from \\\"./components/MedicineDetailsDialog\\\";\\nimport { DeleteMedicineDialog } from \\\"./components/DeleteMedicineDialog\\\";\\nimport { PHARMA_NFT_ADDRESS } from \\\"@/lib/blockchain\\\"; // Import NFT contract address\\n\\nexport default function ManufacturerMedicines() {\\n  const medicines = useQuery(api.medicines.getManufacturerMedicines);\\n  const toggleStatus = useMutation(api.medicines.toggleMedicineStatus);\\n  const deleteMedicine = useMutation(api.medicines.deleteMedicine);\\n  const { account, connectWallet, disconnectWallet } = useWeb3();\\n  \\n  const [selectedMedicine, setSelectedMedicine] = useState<any>(null);\\n  const [isDetailsOpen, setIsDetailsOpen] = useState(false);\\n  const [medicineToDelete, setMedicineToDelete] = useState<any>(null);\\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\\n\\n  const handleToggleStatus = async (id: any, currentStatus: boolean) => {\\n    try {\\n      await toggleStatus({ id, isActive: !currentStatus });\\n      toast.success(`Medicine ${!currentStatus ? \\\"activated\\\" : \\\"deactivated\\\"} successfully`);\\n    } catch (error) {\\n      toast.error(\\\"Failed to update status\\\");\\n      console.error(error);\\n    }\\n  };\\n\\n  const handleDeleteMedicine = async () => {\\n    if (!medicineToDelete) return;\\n    try {\\n      await deleteMedicine({ id: medicineToDelete._id });\\n      toast.success(\\\"Medicine deleted successfully\\\");\\n      setIsDeleteDialogOpen(false);\\n      setMedicineToDelete(null);\\n    } catch (error) {\\n      toast.error(\\\"Failed to delete medicine\\\");\\n      console.error(error);\\n    }\\n  };\\n\\n  const openBlockchain = (tokenId: string) => {\\n    if (!tokenId) {\\n        toast.error(\\\"No token ID available\\\");\\n        return;\\n    }\\n    // Redirect to PolygonScan for Amoy testnet, using NFT contract address and token ID\\n    window.open(`https://amoy.polygonscan.com/token/${PHARMA_NFT_ADDRESS}?a=${tokenId}`, \\\"_blank\\\");\\n  };\\n\\n  return (\\n    <div className=\\\"space-y-8\\\">\\n      <div className=\\\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\\\">\\n        <motion.div\\n          initial={{ opacity: 0, x: -20 }}\\n          animate={{ opacity: 1, x: 0 }}\\n        >\\n          <h1 className=\\\"text-3xl font-bold text-white\\\">My Medicines</h1>\\n          <p className=\\\"text-gray-400\\\">Manage your minted medicine NFTs</p>\\n        </motion.div>\\n        <motion.div\\n          initial={{ opacity: 0, x: 20 }}\\n          animate={{ opacity: 1, x: 0 }}\\n          className=\\\"flex items-center gap-3\\\"\\n        >\\n          {account ? (\\n            <Button \\n              variant=\\\"outline\\\" \\n              onClick={disconnectWallet}\\n              className=\\\"border-cyan-500/20 text-cyan-400 hover:bg-cyan-500/10\\\"\\n            >\\n              <Wallet className=\\\"mr-2 h-4 w-4\\\" />\\n              {account.slice(0, 6)}...{account.slice(-4)}\\n              <LogOut className=\\\"ml-2 h-4 w-4\\\" />\\n            </Button>\\n          ) : (\\n            <Button \\n              variant=\\\"outline\\\" \\n              onClick={connectWallet}\\n              className=\\\"border-cyan-500/20 text-cyan-400 hover:bg-cyan-500/10\\\"\\n            >\\n              <Wallet className=\\\"mr-2 h-4 w-4\\\" />\\n              Connect Wallet\\n            </Button>\\n          )}\\n          <Link to=\\\"/manufacturer/create\\\">\\n            <Button className=\\\"bg-cyan-500 hover:bg-cyan-600 text-white\\\">\\n              <Plus className=\\\"mr-2 h-4 w-4\\\" />\\n              Mint New Medicine\\n            </Button>\\n          </Link>\\n        </motion.div>\\n      </div>\\n\\n      <motion.div\\n        initial={{ opacity: 0, y: 20 }}\\n        animate={{ opacity: 1, y: 0 }}\\n        transition={{ delay: 0.1 }}\\n        className=\\\"bg-slate-900/50 backdrop-blur-xl border border-cyan-500/20 rounded-xl overflow-hidden\\\"\\n      >\\n        <div className=\\\"p-4 border-b border-cyan-500/20 flex items-center gap-4\\\">\\n          <div className=\\\"relative flex-1 max-w-sm\\\">\\n            <Search className=\\\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400\\\" />\\n            <Input\\n              placeholder=\\\"Search medicines...\\\"\\n              className=\\\"pl-9 bg-slate-950/50 border-slate-800 focus:border-cyan-500/50\\\"\\n            />\\n          </div>\\n        </div>\\n\\n        <MedicinesTable \\n          medicines={medicines}\\n          onViewDetails={(medicine) => {\\n            setSelectedMedicine(medicine);\\n            setIsDetailsOpen(true);\\n          }}\\n          onToggleStatus={handleToggleStatus}\\n          onDelete={(medicine) => {\\n            setMedicineToDelete(medicine);\\n            setIsDeleteDialogOpen(true);\\n          }}\\n          onOpenBlockchain={openBlockchain}\\n        />\\n      </motion.div>\\n\\n      <MedicineDetailsDialog \\n        isOpen={isDetailsOpen}\\n        onOpenChange={setIsDetailsOpen}\\n        medicine={selectedMedicine}\\n      />\\n\\n      <DeleteMedicineDialog \\n        isOpen={isDeleteDialogOpen}\\n        onOpenChange={setIsDeleteDialogOpen}\\n        medicine={medicineToDelete}\\n        onConfirm={handleDeleteMedicine}\\n      />\\n    </div>\\n  );\\n}\n\")"
  },
  {
    "tool_code": "await writeToFileTool(\"src/pages/manufacturer/components/MedicinesTable.tsx\", \"import { Button } from \\\"@/components/ui/button\\\";\\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \\\"@/components/ui/table\\\";\\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \\\"@/components/ui/dropdown-menu\\\";\\nimport { Badge }n\" + \" from \\\"@/components/ui/badge\\\";\\nimport { Box, Calendar, MoreVertical, FileText, ExternalLink, Ban, CheckCircle, Trash2 } from \\\"lucide-react\\\";\\n\\ninterface MedicinesTableProps {\\n  medicines: any[] | undefined;\\n  onViewDetails: (medicine: any) => void;\\n  onToggleStatus: (id: any, currentStatus: boolean) => void;\\n  onDelete: (medicine: any) => void;\\n  onOpenBlockchain: (tokenId: string) => void; // Changed txHash to tokenId\\n}\\n\\nexport function MedicinesTable({\\n  medicines,\\n  onViewDetails,\\n  onToggleStatus,\\n  onDelete,\\n  onOpenBlockchain\\n}: MedicinesTableProps) {\\n  return (\\n    <div className=\\\"overflow-x-auto\\\">\\n      <Table>\\n        <TableHeader className=\\\"bg-slate-950/50\\\">\\n          <TableRow className=\\\"hover:bg-transparent border-cyan-500/20\\\">\\n            <TableHead className=\\\"text-gray-400\\\">Medicine Name</TableHead>\\n            <TableHead className=\\\"text-gray-400\\\">Manufacturer</TableHead>\\n            <TableHead className=\\\"text-gray-400\\\">Batch No.</TableHead>\\n            <TableHead className=\\\"text-gray-400\\\">Type</TableHead>\\n            <TableHead className=\\\"text-gray-400\\\">Expiry Date</TableHead>\\n            <TableHead className=\\\"text-gray-400\\\">Quantity</TableHead>\\n            <TableHead className=\\\"text-gray-400\\\">Status</TableHead>\\n            <TableHead className=\\\"w-[50px]\\\">\\n            </TableHead>\\n          </TableRow>\\n        </TableHeader>\\n        <TableBody>\\n          {medicines === undefined ? (\\n            <TableRow>\\n              <TableCell colSpan={8} className=\\\"h-24 text-center text-gray-500\\\">\\n                Loading medicines...\\n              </TableCell>\\n            </TableRow>\\n          ) : medicines.length === 0 ? (\\n            <TableRow>\\n              <TableCell colSpan={8} className=\\\"h-32 text-center text-gray-500\\\">\\n                No medicines found. Mint your first medicine NFT!\\n              </TableCell>\\n            </TableRow>\\n          ) : (\\n            medicines.map((medicine) => (\\n              <TableRow key={medicine._id} className=\\\"hover:bg-slate-800/50 border-slate-800\\\">\\n                <TableCell className=\\\"font-medium text-white\\\">\\n                  <div className=\\\"flex items-center gap-3\\\">\\n                    <div className=\\\"h-8 w-8 rounded bg-cyan-500/10 flex items-center justify-center text-cyan-400\\\">\\n                      <Box className=\\\"h-4 w-4\\\" />\\n                    </div>\\n                    {medicine.medicineName}\\n                  </div>\\n                </TableCell>\\n                <TableCell className=\\\"text-gray-300\\\">{medicine.manufacturerName}</TableCell>\\n                <TableCell className=\\\"text-gray-300\\\">{medicine.batchNumber}</TableCell>\\n                <TableCell className=\\\"text-gray-300 capitalize\\\">{medicine.medicineType}</TableCell>\\n                <TableCell className=\\\"text-gray-300\\\">\\n                  <div className=\\\"flex items-center gap-2\\\">\\n                    <Calendar className=\\\"h-3 w-3 text-gray-500\\\" />\\n                    {medicine.expiryDate}\\n                  </div>\\n                </TableCell>\\n                <TableCell className=\\\"text-gray-300\\\">{medicine.quantity}</TableCell>\\n                <TableCell>\\n                  <Badge\\n                    variant=\\\"outline\\\"\\n                    className={\\n                      medicine.isActive\\n                        ? \\\"bg-green-500/10 text-green-400 border-green-500/20\\\"\\n                        : \\\"bg-red-500/10 text-red-400 border-red-500/20\\\"\\n                    }\\n                  >\\n                    {medicine.isActive ? \\\"Active\\\" : \\\"Inactive\\\"}\\n                  </Badge>\\n                </TableCell>\\n                <TableCell>\\n                  <DropdownMenu>\\n                    <DropdownMenuTrigger asChild>\\n                      <Button variant=\\\"ghost\\\" size=\\\"icon\\\" className=\\\"h-8 w-8 text-gray-400 hover:text-white\\\">\\n                        <MoreVertical className=\\\"h-4 w-4\\\" />\\n                      </Button>\\n                    </DropdownMenuTrigger>\\n                    <DropdownMenuContent align=\\\"end\\\" className=\\\"bg-slate-900 border-slate-800 text-gray-300\\\">\\n                      <DropdownMenuItem \\n                        className=\\\"hover:bg-slate-800 focus:bg-slate-800 cursor-pointer\\\"\\n                        onClick={() => onViewDetails(medicine)}\\n                      >\\n                        <FileText className=\\\"mr-2 h-4 w-4\\\" />\\n                        View Details\\n                      </DropdownMenuItem>\\n                      <DropdownMenuItem \\n                        className=\\\"hover:bg-slate-800 focus:bg-slate-800 cursor-pointer\\\"\\n                        onClick={() => onOpenBlockchain(medicine.tokenId)} \\n                      >\\n                        <ExternalLink className=\\\"mr-2 h-4 w-4\\\" />\\n                        View on Blockchain\\n                      </DropdownMenuItem>\\n                      <DropdownMenuItem \\n                        className={`hover:bg-slate-800 focus:bg-slate-800 cursor-pointer ${medicine.isActive ? \\\"text-yellow-400\\\" : \\\"text-green-400\\\"}`}\\n                        onClick={() => onToggleStatus(medicine._id, medicine.isActive)}\\n                      >\\n                        {medicine.isActive ? (\\n                          <>\\n                            <Ban className=\\\"mr-2 h-4 w-4\\\" />\\n                            Deactivate\\n                          </>\\n                        ) : (\\n                          <>\\n                            <CheckCircle className=\\\"mr-2 h-4 w-4\\\" />\\n                            Activate\\n                          </>\\n                        )}\\n                      </DropdownMenuItem>\\n                      <DropdownMenuItem\\n                        className=\\\"hover:bg-slate-800 focus:bg-slate-800 cursor-pointer text-red-400 focus:text-red-400\\\"\\n                        onClick={() => onDelete(medicine)}\\n                      >\\n                        <Trash2 className=\\\"mr-2 h-4 w-4\\\" />\\n                        Delete\\n                      </DropdownMenuItem>\\n                    </DropdownMenuContent>\\n                  </DropdownMenu>\\n                </TableCell>\\n              </TableRow>\\n            ))\\n          )}\\n        </TableBody>\\n      </Table>\\n    </div>\\n  );\\n}\n\")"
  }
]